# Tapa (Puzzle Type #48)

This is a dedicated solver for Tapa.

Below are the details of how to utilize the solver. In addition, the solver gives all possible solutions to the input thus it can be utilized to figure out if a single partial input board has multiple possible solutions.

(The solver under the hood mainly utilizes the CP-SAT solver from Google OR-Tools)

* [**Play online**](https://www.puzzle-tapa.com/)

* [**Instructions**](https://www.gmpuzzles.com/blog/tapa-rules-and-info/)

You are given a grid where some cells have numbers. Your goal is to shade some cells black to satisfy the following rules:

   - Cells with numbers cannot be shaded
   - The shaded cells cannot form a 2×2 square
   - Numbers in a cell indicate the length of consecutive shaded blocks in the neighboring cells. If there is more than one number in a cell, then there must be at least one white (unshaded) cell between the black cell groups.
   - The shaded cells should form a single connected area.
   - The numbers in a cell represent the length of consecutive shaded blocks in the 8 neighboring cells. 
     - A single number N represents N consecutive shaded cells around the number.
     - Multiple numbers represent multiple consecutive shaded cells around the number, each separated by at least one white cell.

**Unsolved puzzle**

<img src="https://raw.githubusercontent.com/Ar-Kareem/puzzle_solver/master/images/puzzles/tapa_unsolved.png" alt="Tapa unsolved" width="500">

Code to utilize this package and solve the puzzle:

```python
import numpy as np
from puzzle_solver import tapa_solver as solver
board = np.array([
    ['   ', '   ', '   ', '   ', '   ', '3  ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '3  ', '   ', '   ', '   ', '   ', '   '],
    ['   ', '   ', '   ', '   ', '2/3', '   ', '   ','1/2/2','   ', '3/3', '7  ', '   ', '7  ', '   ', '   ', '2/3', '   ', '   ', '   ', '   '],
    ['   ', '2/4', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '2/3', '   '],
    ['   ', '   ', '   ', '1/3','1/1/2','   ', '   ', '7  ', '   ', '   ', '   ', '   ', '7  ', '   ','   ','1/1/1/1','1/3','   ', '   ', '   '],
    ['   ', '   ','1/1/3','   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '1/4', '   ', '   '],

    ['   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ','1/1/3','1/2', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   '],
    ['   ', '   ', '5  ', '   ', '   ','1/1/1','1/1', '   ', '   ', '   ', '   ', '   ', '   ', '1/3', '2/3', '   ', '   ', '3/3', '   ', '   '],
    ['   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   '],

    ['   ', '   ','1/1/2','   ', '   ', '   ', '   ', '   ', '7  ', '3/3', '3/3', '2/4', '   ', '   ', '   ', '   ', '   ', '6  ', '   ', '   '],
    ['   ', '1/4', '   ', '   ', '2/3', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '2/4', '   ', '   ', '1/3', '   '],
    ['   ', '1/3', '   ', '   ', '1/4', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '2/3', '   ', '   ','1/1/2','   '],
    ['   ', '   ', '6  ', '   ', '   ', '   ', '   ', '   ', '1/1', '1/2','1/1/2','1/4', '   ', '   ', '   ', '   ', '   ', '6  ', '   ', '   '],
    ['   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   '],

    ['   ', '   ', '3/3', '   ', '   ', '1/2', '1/1', '   ', '   ', '   ', '   ', '   ', '   ', '1/3','1/1/3','   ', '   ', '2/3', '   ', '   '],
    ['   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '4  ', '1/3', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   '],
    ['   ', '   ', '1/4', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '1/3', '   ', '   '],

    ['   ', '   ', '   ', '1/3','1/1/3','   ', '   ', '6  ', '   ', '   ', '   ', '   ', '7  ', '   ', '   ','1/1/2','1/3', '   ', '   ', '   '],
    ['   ', '2/3', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '2/3', '   '],
    ['   ', '   ', '   ', '   ', '2/3', '   ', '   ', '6  ', '   ', '1/3', '4  ', '   ', '6  ', '   ', '   ', '2/3', '   ', '   ', '   ', '   '],
    ['   ', '   ', '   ', '   ', '   ', '1/1', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '   ', '1/1', '   ', '   ', '   ', '   ', '   '],
])
binst = solver.Board(board=board)
solutions = binst.solve_and_print()
```

**Script Output**

```python
Solution found
    0   0   0   0   0   0   0   0   0   0   1   1   1   1   1   1   1   1   1   1  
    0   1   2   3   4   5   6   7   8   9   0   1   2   3   4   5   6   7   8   9  
  ┌───┬───┬───┬───┬───┬───┬───┬───┬───┬───┬───┬───┬───┬───┬───┬───┬───┬───┬───┬───┐
 0│   │▒▒▒│▒▒▒│▒▒▒│   │ 3 │▒▒▒│   │▒▒▒│▒▒▒│▒▒▒│▒▒▒│▒▒▒│▒▒▒│ 3 │   │▒▒▒│▒▒▒│▒▒▒│▒▒▒│
  ├───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┤
 1│▒▒▒│▒▒▒│   │▒▒▒│2/3│▒▒▒│▒▒▒│...│   │3/3│ 7 │▒▒▒│ 7 │▒▒▒│▒▒▒│2/3│▒▒▒│   │   │▒▒▒│
  ├───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┤
 2│▒▒▒│2/4│▒▒▒│▒▒▒│   │▒▒▒│   │▒▒▒│▒▒▒│▒▒▒│▒▒▒│▒▒▒│▒▒▒│   │▒▒▒│   │▒▒▒│▒▒▒│2/3│▒▒▒│
  ├───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┤
 3│▒▒▒│   │▒▒▒│1/3│...│▒▒▒│▒▒▒│ 7 │▒▒▒│   │   │▒▒▒│ 7 │▒▒▒│   │...│1/3│▒▒▒│   │▒▒▒│
  ├───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┤
 4│▒▒▒│▒▒▒│...│▒▒▒│   │   │▒▒▒│▒▒▒│▒▒▒│   │▒▒▒│▒▒▒│▒▒▒│▒▒▒│▒▒▒│   │▒▒▒│1/4│   │▒▒▒│
  ├───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┤
 5│▒▒▒│   │▒▒▒│▒▒▒│▒▒▒│   │▒▒▒│   │▒▒▒│...│1/2│   │   │   │▒▒▒│▒▒▒│▒▒▒│▒▒▒│▒▒▒│▒▒▒│
  ├───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┤
 6│▒▒▒│   │ 5 │▒▒▒│   │...│1/1│   │▒▒▒│   │▒▒▒│   │   │1/3│2/3│▒▒▒│   │3/3│   │▒▒▒│
  ├───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┤
 7│▒▒▒│   │▒▒▒│▒▒▒│▒▒▒│   │   │▒▒▒│▒▒▒│▒▒▒│▒▒▒│▒▒▒│▒▒▒│▒▒▒│▒▒▒│   │▒▒▒│▒▒▒│▒▒▒│▒▒▒│
  ├───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┤
 8│▒▒▒│▒▒▒│...│   │▒▒▒│▒▒▒│   │▒▒▒│ 7 │3/3│3/3│2/4│▒▒▒│   │   │▒▒▒│▒▒▒│ 6 │   │▒▒▒│
  ├───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┤
 9│▒▒▒│1/4│   │▒▒▒│2/3│▒▒▒│▒▒▒│▒▒▒│▒▒▒│▒▒▒│▒▒▒│▒▒▒│   │   │▒▒▒│2/4│▒▒▒│▒▒▒│1/3│▒▒▒│
  ├───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┤
10│▒▒▒│1/3│▒▒▒│▒▒▒│1/4│   │▒▒▒│   │   │▒▒▒│   │▒▒▒│▒▒▒│▒▒▒│▒▒▒│2/3│▒▒▒│   │...│▒▒▒│
  ├───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┤
11│▒▒▒│   │ 6 │▒▒▒│▒▒▒│   │▒▒▒│   │1/1│1/2│...│1/4│▒▒▒│   │   │   │▒▒▒│ 6 │▒▒▒│   │
  ├───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┤
12│▒▒▒│▒▒▒│▒▒▒│▒▒▒│   │   │▒▒▒│   │   │▒▒▒│▒▒▒│   │▒▒▒│▒▒▒│   │▒▒▒│▒▒▒│▒▒▒│▒▒▒│▒▒▒│
  ├───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┤
13│▒▒▒│   │3/3│   │   │1/2│1/1│   │▒▒▒│▒▒▒│   │▒▒▒│▒▒▒│1/3│...│▒▒▒│   │2/3│   │▒▒▒│
  ├───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┤
14│▒▒▒│▒▒▒│▒▒▒│▒▒▒│▒▒▒│▒▒▒│   │   │▒▒▒│ 4 │1/3│▒▒▒│   │▒▒▒│   │▒▒▒│▒▒▒│▒▒▒│   │▒▒▒│
  ├───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┤
15│▒▒▒│   │1/4│▒▒▒│   │▒▒▒│▒▒▒│▒▒▒│▒▒▒│   │   │▒▒▒│▒▒▒│▒▒▒│   │   │▒▒▒│1/3│   │▒▒▒│
  ├───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┤
16│▒▒▒│   │▒▒▒│1/3│...│▒▒▒│   │ 6 │▒▒▒│▒▒▒│▒▒▒│▒▒▒│ 7 │▒▒▒│▒▒▒│...│1/3│▒▒▒│   │▒▒▒│
  ├───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┤
17│▒▒▒│2/3│▒▒▒│▒▒▒│   │▒▒▒│   │▒▒▒│▒▒▒│   │   │▒▒▒│▒▒▒│   │▒▒▒│   │▒▒▒│▒▒▒│2/3│▒▒▒│
  ├───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┤
18│▒▒▒│   │   │▒▒▒│2/3│▒▒▒│   │ 6 │▒▒▒│1/3│ 4 │▒▒▒│ 6 │   │▒▒▒│2/3│▒▒▒│   │   │▒▒▒│
  ├───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┤
19│▒▒▒│▒▒▒│▒▒▒│▒▒▒│   │1/1│▒▒▒│▒▒▒│▒▒▒│   │▒▒▒│▒▒▒│▒▒▒│▒▒▒│1/1│   │▒▒▒│▒▒▒│▒▒▒│▒▒▒│
  └───┴───┴───┴───┴───┴───┴───┴───┴───┴───┴───┴───┴───┴───┴───┴───┴───┴───┴───┴───┘
Solutions found: 1
status: OPTIMAL
Time taken: 14.20 seconds
```

**Solved puzzle**

<img src="https://raw.githubusercontent.com/Ar-Kareem/puzzle_solver/master/images/puzzles/tapa_solved.png" alt="Tapa solved" width="500">
